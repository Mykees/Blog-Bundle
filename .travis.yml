language: php

php:
    - 5.6

env:
    - SYMFONY_VERSION=2.6.*

before_script:
    - mysql -e "create database test;"
    - composer self-update
    - composer require symfony/symfony:${SYMFONY_VERSION}
    - composer install --dev
    - chmod -R 777 Tests/Fixtures/app/web
    - chmod -R 777 Tests/Fixtures/app/web/img
    - php Tests/Fixtures/app/console --env=test doctrine:schema:create
    - php Tests/Fixtures/app/console --env=test doctrine:schema:update --force
    - php Tests/Fixtures/app/console --env=test assetic:dump


after_script:
    - php Tests/Fixtures/app/console --env=test doctrine:database:drop --force

script:
    - phpunit